# 性能优化

## 模型选择策略

**Haiku 4.5** (Sonnet 90% 的能力，节省 3 倍成本)：
- 频繁调用的轻量级智能体
- 结对编程和代码生成
- 多智能体系统中的工作智能体

**Sonnet 4.5** (最强编码模型)：
- 主要开发工作
- 编排多智能体工作流
- 复杂编码任务

**Opus 4.5** (最深层推理)：
- 复杂架构决策
- 最高的推理需求
- 研究与分析任务

## 上下文窗口管理

避免在上下文窗口最后 20% 进行：
- 大规模重构
- 跨多个文件的特性实现
- 调试复杂交互

对上下文敏感度较低的任务：
- 单文件编辑
- 独立工具函数创建
- 文档更新
- 简单 Bug 修复

## Ultrathink + 计划模式

对于需要深层推理的复杂任务：
1. 使用 `ultrathink` 增强思考能力
2. 启用 **Plan Mode** (计划模式) 以采用结构化方法
3. 通过多轮批判 "预热引擎" (Rev the engine)
4. 使用分角色的子智能体进行多元化分析

## 构建故障排除

如果构建失败：
1. 使用 **build-error-resolver** (构建错误修复者) 智能体
2. 分析错误信息
3. 增量修复
4. 每次修复后验证
